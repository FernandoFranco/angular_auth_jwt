{"version":3,"sources":["_auth.js","configurations/shared.config.js","providers/auth.provider.js","services/auth.service.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"aaj.js","sourcesContent":["/**\r\n * Fernando Franco\r\n * Angular Module\r\n */\r\n(function (angular) {\r\n    'use strict';\r\n    angular.module('auth.jwt', ['ngStorage', 'angular-jwt']);\r\n\r\n    angular.module('auth.jwt').run(authJwt);\r\n\r\n    authJwt.$inject = ['$rootScope', 'authManager', 'authJwtService'];\r\n\r\n    function authJwt($rootScope, authManager, authService) {\r\n\r\n        _init();\r\n\r\n        $rootScope.$on('tokenHasExpired', _tokenHasExpired);\r\n\r\n        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n        function _init() {\r\n            authManager.checkAuthOnRefresh();\r\n            authManager.redirectWhenUnauthenticated();\r\n        }\r\n\r\n        function _tokenHasExpired() {\r\n            authService.singOut();\r\n            $rootScope.$broadcast('auth.jwt.expired');\r\n        }\r\n    }\r\n})(angular);","/**\r\n * Fernando Franco\r\n * Config Module\r\n */\r\n(function (angular) {\r\n    'use strict';\r\n    angular.module('auth.jwt').config(sharedConfig);\r\n\r\n    sharedConfig.$inject = ['$httpProvider', 'jwtOptionsProvider', 'authJwtProvider'];\r\n\r\n    function sharedConfig($httpProvider, jwtOptionsProvider, authJwtProvider) {\r\n        jwtOptionsProvider.config({\r\n            tokenGetter: authJwtProvider.tokenGetter,\r\n            unauthenticatedRedirector: authJwtProvider.unauthenticatedRedirector\r\n        });\r\n\r\n        $httpProvider.interceptors.push('jwtInterceptor');\r\n    }\r\n})(angular);","/**\r\n * Fernando Franco\r\n * Provider Auth\r\n */\r\n(function (angular) {\r\n    'use strict';\r\n    angular.module('auth.jwt').provider('authJwt', authProvider);\r\n\r\n    authProvider.$inject = ['$localStorageProvider'];\r\n\r\n    function authProvider($localStorageProvider) {\r\n        var provider = {};\r\n\r\n        return {\r\n            tokenGetter: _tokenGetterProvider($localStorageProvider),\r\n            unauthenticatedRedirector: _unauthenticatedRedirector,\r\n            $get: function () {\r\n                return provider;\r\n            }\r\n        };\r\n    }\r\n\r\n    function _tokenGetterProvider($localStorageProvider) {\r\n        return function _tokenGetter(options) {\r\n            if (options && options.url && options.url.substr(options.url.length - 5) === '.html') {\r\n                return null;\r\n            }\r\n            return $localStorageProvider && $localStorageProvider.get('jwt');\r\n        }\r\n    }\r\n\r\n    _unauthenticatedRedirector.$inject = ['$rootScope'];\r\n\r\n    function _unauthenticatedRedirector($rootScope) {\r\n        $rootScope.$broadcast('auth.jwt.unauthenticated');\r\n    }\r\n})(angular);","/**\r\n * Fernando Franco\r\n * Service Auth\r\n */\r\n(function (angular) {\r\n    'use strict';\r\n    angular.module('auth.jwt').service('authJwtService', authService);\r\n\r\n    authService.$inject = ['$q', '$http', '$timeout', '$localStorage', 'jwtHelper'];\r\n\r\n    function authService($q, $http, $timeout, $localStorage, jwtHelper) {\r\n        var service = this;\r\n\r\n        service.data = _getData();\r\n\r\n        service.singIn = _singIn;\r\n        service.singOut = _singOut;\r\n        service.getRole = _getRole;\r\n\r\n        return service;\r\n\r\n        ////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n        function _getData() {\r\n            try {\r\n                return jwtHelper.decodeToken($localStorage.jwt);\r\n            } catch (error) {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        function _getRole(attribute) {\r\n            if (!service.data) {\r\n                return null;\r\n            }\r\n\r\n            if (!service.data.role) {\r\n                return null;\r\n            }\r\n\r\n            if (attribute) {\r\n                return service.data.role[attribute];\r\n            }\r\n\r\n            return service.data.role;\r\n        }\r\n\r\n        function _singIn(email, secret, authRoute) {\r\n            var deferred = $q.defer();\r\n\r\n            $http.post(authRoute, {\r\n                email: email,\r\n                secret: secret\r\n            }).then(function (response) {\r\n                if (response && response.data && response.data.token) {\r\n                    $localStorage.jwt = response.data.token;\r\n                    service.data = _getData();\r\n\r\n                    return $timeout(function () {\r\n                        deferred.resolve();\r\n                    }, 300);\r\n                }\r\n\r\n                deferred.reject(new Error('Token not Found'));\r\n            }).catch(function (error) {\r\n                deferred.reject(error.data || error);\r\n            });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        function _singOut() {\r\n            delete $localStorage.jwt;\r\n        }\r\n    }\r\n})(angular);"]}